{% extends 'schedule/base_list.html' %}

{% block title %}Бронирование помещений{% endblock title %}

{% block table %}
    <table class="table text-center table-sm table-hover">
        <thead>
        <tr class="table-secondary">
            <td colspan="7"><p class="h3">Заявки на обработку</p></td>
        </tr>
        <tr>
            <th scope="col">Дата и время</th>
            <th scope="col">Мероприятие</th>
            <th scope="col">Адрес</th>
            <th scope="col">Организация</th>
            <th scope="col">Ответственный</th>
            <th scope="col">Действие</th>
        </tr>
        </thead>
        <tbody>
        {% for event in page_obj %}
            {% if event.booking_status == statuses.STATUS_WAIT %}
                <tr>
                    <td>{{ event.time_start|date:"H:i" }}-{{ event.time_end|date:"H:i" }} {{ event.date|date:"d.m.Y" }}</td>
                    <td>{{ event.name }}</td>
                    <td>{{ event.booking_room.address }} ({{ event.booking_room.room }})</td>
                    <td>{{ event.organization }}</td>
                    <td>{{ event.owner }}</td>
                    <td>
                        <a class="btn btn-success" href="{% url 'booking_approve' pk=event.pk %}" role="button">Обработать</a>
                    </td>
                </tr>
            {%  endif %}
        {% endfor %}
        </tbody>
    </table>
    <table class="table text-center table-sm table-hover">
        <thead>
        <tr class="table-secondary">
            <td colspan="7">
                <div class="row">
                    <div class=" col h3">Забронированные помещения </div>
                    <div class="col">
                        <form action=""  method="POST">
                            {% csrf_token %}
                            <input type="submit" name="send_telegram_all" class="btn btn-secondary"
                                   value="Отправить в телеграм">
                            <input type="submit" name="send_telegram_today" class="btn btn-secondary"
                                   value="Отправить в телеграм за сегодня">
                        </form>
                    </div>
                </div>
            </td>
        </tr>
        <tr>
            <th scope="col">Дата и время</th>
            <th scope="col">Мероприятие</th>
            <th scope="col">Адрес</th>
            <th scope="col">Организация</th>
            <th scope="col">Ответственный</th>
            <th scope="col">Действие</th>
        </tr>
        </thead>
        <tbody>
        {% for event in page_obj %}
            {% if event.booking_status == statuses.STATUS_READY %}
                <tr>
                    <td>{{ event.time_start|date:"H:i" }}-{{ event.time_end|date:"H:i" }} {{ event.date|date:"d.m.Y" }}</td>
                    <td>{{ event.name }}</td>
                    <td>{{ event.booking_room.address }} ({{ event.booking_room.room }})</td>
                    <td>{{ event.organization }}</td>
                    <td>{{ event.owner }}</td>
                    <td>
                        <a class="btn btn-success" href="{% url 'booking_approve' pk=event.pk %}" role="button">Изменить</a>
                    </td>
                </tr>
            {% endif %}
        {% endfor %}
        </tbody>
    </table>
{% endblock table %}